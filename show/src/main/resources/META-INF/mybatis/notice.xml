<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.idev.mapper.NoticeMapper">
	<select id="selectAll" resultType="Notice">		
		SELECT * FROM notice
	</select>
	<select id="selectOne" parameterType="int" resultType="Notice">		
		SELECT * FROM notice
		WHERE notice_idx=#{notice_idx}
	</select>
	
	<!-- 글 수정하기 -->
	<update id="updateNotice" parameterType="Map">
		UPDATE notice 
			<!-- SET notice_title=#{notice_title, jdbcType=VARCHAR}, notice_content=#{notice_content, jdbcType=VARCHAR} -->
 			SET notice_title=#{notice_title}, notice_content=#{notice_content}
		WHERE notice_idx=#{notice_idx}
	</update>
	
	<!-- 글 삭제하기 -->
	<delete id="deleteNotice" parameterType="int">
		DELETE FROM notice WHERE notice_idx=#{notice_idx}
	</delete>
	
	<!-- 전체 공지사항 페이징 -->
	<select id="getPageList" parameterType="Map" resultType="Notice">
		SELECT * FROM (
			SELECT rownum AS R, T.* FROM 
				(SELECT * FROM notice ORDER BY notice_idx DESC) T )
		WHERE R BETWEEN #{startNo} AND #{endNo}
	</select>
	
	<!-- 전체 공지사항 수 -->
	<select id="getCount" resultType="int">
		SELECT count(*) FROM notice
	</select>
	
	<!-- 검색 공지사항 페이징 -->
	<select id="searchPageList" parameterType="Map" resultType="Notice">
		SELECT * FROM (
			SELECT rownum AS R, T.* FROM 
				(SELECT * from notice
		<if test="columns=='title'">
		 WHERE notice_title like '%'||#{find}||'%'
		</if>
		<if test="columns=='content'">
 		 WHERE notice_content like '%'||#{find}||'%'
		</if>
		<if test="columns=='titleContent'">
		 WHERE notice_title like '%'||#{find}||'%'
		 	OR notice_content like '%'||#{find}||'%'
		</if>
		ORDER BY notice_idx DESC) T )
		WHERE R BETWEEN #{startNo} AND #{endNo}
	</select>
	<!-- 검색 공지사항 수 -->
	<select id="getSearchCount" parameterType="Map" resultType="int">
		SELECT count(*) FROM notice
		<if test="columns=='title'">
		 WHERE notice_title like '%'||#{find}||'%'
		</if>
		<if test="columns=='content'">
 		 WHERE notice_content like '%'||#{find}||'%'
		</if>
		<if test="columns=='titleContent'">
		 WHERE notice_title like '%'||#{find}||'%'
		 	OR notice_content like '%'||#{find}||'%'
		</if>
	</select>
	
	<!-- 조회수 증가 -->
	<update id="readCount" parameterType="int">
		UPDATE notice 
			SET notice_view=notice_view+1
		WHERE notice_idx=#{notice_idx}
	</update>

	<!-- 글쓰기 -->
	<insert id="insertNotice" parameterType="Notice">
		INSERT INTO notice (notice_idx,notice_title,notice_content)
		VALUES (notice_idx_seq.nextval,#{notice_title},#{notice_content})
	</insert>




</mapper>